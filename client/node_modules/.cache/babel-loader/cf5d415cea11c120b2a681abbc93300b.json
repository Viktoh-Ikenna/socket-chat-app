{"ast":null,"code":"var _jsxFileName = \"/home/chidex/Documents/Socket-Chat-App-main/client/src/App.js\";\nimport React, { useState, useEffect } from \"react\";\nimport io from \"socket.io-client\";\nimport { ShowOnline } from './showOnline';\nimport \"./App.css\";\nlet socket;\nconst CONNECTION_PORT = \"localhost:3002/\";\n\nfunction App() {\n  // Before Login\n  const [loggedIn, setLoggedIn] = useState(false);\n  const [room, setRoom] = useState(\"\");\n  const [userName, setUserName] = useState(\"\"); // After Login\n\n  const [message, setMessage] = useState(\"\");\n  const [messageList, setMessageList] = useState([]);\n  const [userList, setUsers] = useState([]);\n  useEffect(() => {\n    socket = io(CONNECTION_PORT);\n  }, [CONNECTION_PORT]);\n  useEffect(() => {\n    socket.on(\"receive_message\", data => {\n      setMessageList([...messageList, data]);\n    });\n  });\n  useEffect(() => {\n    socket.on(\"online_users\", data => {\n      // setMessageList([...messageList, data]);\n      setUsers(prev => {\n        return [...prev, data];\n      });\n    });\n  }, []);\n  useEffect(() => {\n    if (userList[0]) {\n      socket.on(\"disconnected\", data => {\n        // setMessageList([...messageList, data]);\n        const userss = [...userList.filter(id => id.id === data)];\n        let offline = { ...userss[0],\n          status: false\n        };\n        console.log(offline);\n\n        if (offline.name) {}\n\n        setUsers(prev => {\n          return [...prev.filter(d => d.id !== data), offline];\n        });\n        console.log(userList);\n      });\n    }\n  });\n\n  const connectToRoom = () => {\n    setLoggedIn(true);\n    socket.emit(\"online\", userName);\n  };\n\n  const sendMessage = async () => {\n    let messageContent = {\n      room: room,\n      content: {\n        author: userName,\n        message: message\n      }\n    };\n    await socket.emit(\"send_message\", messageContent);\n    setMessageList([...messageList, messageContent.content]);\n    setMessage(\"\");\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"App\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 5\n    }\n  }, !loggedIn ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"logIn\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"inputs\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    placeholder: \"Name...\",\n    onChange: e => {\n      setUserName(e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: connectToRoom,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 11\n    }\n  }, \"Enter Chat\")) : /*#__PURE__*/React.createElement(ShowOnline, {\n    messageList: messageList,\n    users: userList,\n    setMessage: setMessage,\n    sendMessage: sendMessage,\n    userName: userName,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 11\n    }\n  }));\n}\n\nexport default App;","map":{"version":3,"sources":["/home/chidex/Documents/Socket-Chat-App-main/client/src/App.js"],"names":["React","useState","useEffect","io","ShowOnline","socket","CONNECTION_PORT","App","loggedIn","setLoggedIn","room","setRoom","userName","setUserName","message","setMessage","messageList","setMessageList","userList","setUsers","on","data","prev","userss","filter","id","offline","status","console","log","name","d","connectToRoom","emit","sendMessage","messageContent","content","author","e","target","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport io from \"socket.io-client\";\nimport {ShowOnline} from './showOnline'\nimport \"./App.css\";\n\nlet socket;\nconst CONNECTION_PORT = \"localhost:3002/\";\n\nfunction App() {\n  // Before Login\n  const [loggedIn, setLoggedIn] = useState(false);\n  const [room, setRoom] = useState(\"\");\n  const [userName, setUserName] = useState(\"\");\n\n  // After Login\n  const [message, setMessage] = useState(\"\");\n  const [messageList, setMessageList] = useState([]);\n  const [userList,setUsers]=useState([]);\n\n  useEffect(() => {\n    socket = io(CONNECTION_PORT);\n  }, [CONNECTION_PORT]);\n\n  useEffect(() => {\n    socket.on(\"receive_message\", (data) => {\n      setMessageList([...messageList, data]);\n    });\n  });\n  useEffect(() => {\n    socket.on(\"online_users\", (data) => {\n      // setMessageList([...messageList, data]);\n      setUsers((prev)=>{\n        return[...prev,data]\n      })\n    });\n  },[]);\n  useEffect(() => {\n    if(userList[0]){\n      socket.on(\"disconnected\", (data) => {\n        // setMessageList([...messageList, data]);\n        const userss=[...userList.filter(id=>id.id===data)];\n       \n        let offline={...userss[0],status:false}\n        console.log(offline)\n        if(offline.name){\n          \n        }\n      setUsers(prev=>{\n        return[...prev.filter(d=>d.id!==data),offline]\n      });\n        console.log(userList)\n      });\n    }\n    \n  });\n  const connectToRoom = () => {\n    setLoggedIn(true);\n    \n   socket.emit(\"online\", userName);\n  };\n\n  const sendMessage = async () => {\n    let messageContent = {\n      room: room,\n      content: {\n        author: userName,\n        message: message,\n      },\n    };\n\n    await socket.emit(\"send_message\", messageContent);\n    setMessageList([...messageList, messageContent.content]);\n    setMessage(\"\");\n  };\n\n  return (\n    <div className=\"App\">\n      {!loggedIn ? (\n        <div className=\"logIn\">\n          <div className=\"inputs\">\n            <input\n              type=\"text\"\n              placeholder=\"Name...\"\n              onChange={(e) => {\n                setUserName(e.target.value);\n              }}\n            />\n          </div>\n          <button onClick={connectToRoom}>Enter Chat</button>\n        </div>\n      ) : <ShowOnline messageList={messageList} users={userList} setMessage={setMessage} sendMessage={sendMessage} userName={userName}/>}\n  </div>\n  )}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}